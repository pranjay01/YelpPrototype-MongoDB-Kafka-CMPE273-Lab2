[2020-10-30 17:03:58,738] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-10-30 17:04:03,416] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-10-30 17:04:05,184] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2020-10-30 17:04:05,818] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2020-10-30 17:04:06,214] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-10-30 17:04:06,560] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-10-30 17:04:06,560] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-10-30 17:04:07,277] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-10-30 17:04:19,599] ERROR [ControllerEventThread controllerId=0] Error processing event RegisterBrokerAndReelect (kafka.controller.ControllerEventManager$ControllerEventThread)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:127)
	at kafka.zk.KafkaZkClient.checkedEphemeralCreate(KafkaZkClient.scala:1476)
	at kafka.zk.KafkaZkClient.registerBrokerInZk(KafkaZkClient.scala:84)
	at kafka.controller.KafkaController$RegisterBrokerAndReelect$.process(KafkaController.scala:1487)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply$mcV$sp(ControllerEventManager.scala:69)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:69)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:69)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:68)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2020-10-30 17:04:20,147] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-10-30 17:04:21,150] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-10-30 17:04:22,044] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2020-10-30 17:04:22,420] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2020-10-30 17:04:23,475] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-10-30 17:04:26,171] INFO [Controller id=0] 0 successfully elected as the controller (kafka.controller.KafkaController)
[2020-10-30 17:04:26,616] INFO [Controller id=0] Reading controller epoch from ZooKeeper (kafka.controller.KafkaController)
[2020-10-30 17:04:27,644] INFO [Controller id=0] Initialized controller epoch to 6 and zk version 5 (kafka.controller.KafkaController)
[2020-10-30 17:04:28,631] INFO [Controller id=0] Incrementing controller epoch in ZooKeeper (kafka.controller.KafkaController)
[2020-10-30 17:04:30,390] INFO [Controller id=0] Epoch incremented to 7 (kafka.controller.KafkaController)
[2020-10-30 17:04:31,805] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-10-30 17:06:33,222] ERROR [Controller id=0] Error while electing or becoming controller on broker 0 (kafka.controller.KafkaController)
kafka.zookeeper.ZooKeeperClientExpiredException: Session expired either before or while waiting for connection
	at kafka.zookeeper.ZooKeeperClient$$anonfun$kafka$zookeeper$ZooKeeperClient$$waitUntilConnected$1.apply$mcV$sp(ZooKeeperClient.scala:233)
	at kafka.zookeeper.ZooKeeperClient$$anonfun$kafka$zookeeper$ZooKeeperClient$$waitUntilConnected$1.apply(ZooKeeperClient.scala:221)
	at kafka.zookeeper.ZooKeeperClient$$anonfun$kafka$zookeeper$ZooKeeperClient$$waitUntilConnected$1.apply(ZooKeeperClient.scala:221)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:250)
	at kafka.zookeeper.ZooKeeperClient.kafka$zookeeper$ZooKeeperClient$$waitUntilConnected(ZooKeeperClient.scala:221)
	at kafka.zookeeper.ZooKeeperClient$$anonfun$waitUntilConnected$1.apply$mcV$sp(ZooKeeperClient.scala:215)
	at kafka.zookeeper.ZooKeeperClient$$anonfun$waitUntilConnected$1.apply(ZooKeeperClient.scala:215)
	at kafka.zookeeper.ZooKeeperClient$$anonfun$waitUntilConnected$1.apply(ZooKeeperClient.scala:215)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:250)
	at kafka.zookeeper.ZooKeeperClient.waitUntilConnected(ZooKeeperClient.scala:214)
	at kafka.zk.KafkaZkClient.retryRequestsUntilConnected(KafkaZkClient.scala:1461)
	at kafka.zk.KafkaZkClient.kafka$zk$KafkaZkClient$$retryRequestUntilConnected(KafkaZkClient.scala:1437)
	at kafka.zk.KafkaZkClient.registerZNodeChangeHandlerAndCheckExistence(KafkaZkClient.scala:1176)
	at kafka.controller.KafkaController$$anonfun$onControllerFailover$5.apply(KafkaController.scala:225)
	at kafka.controller.KafkaController$$anonfun$onControllerFailover$5.apply(KafkaController.scala:225)
	at scala.collection.immutable.List.foreach(List.scala:392)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:225)
	at kafka.controller.KafkaController.kafka$controller$KafkaController$$elect(KafkaController.scala:1203)
	at kafka.controller.KafkaController$Reelect$.process(KafkaController.scala:1479)
	at kafka.controller.KafkaController$RegisterBrokerAndReelect$.process(KafkaController.scala:1488)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply$mcV$sp(ControllerEventManager.scala:69)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:69)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:69)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:68)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)
[2020-10-30 17:06:34,311] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-10-30 17:06:34,700] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-10-30 17:06:35,151] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2020-10-30 17:06:35,627] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2020-10-30 17:06:36,272] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
